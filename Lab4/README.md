# Q1

  Origin IP address: 192.168.0.106
  
# Q2
  
  By checking the modsec logs:
      
    cat modsec_audit.log | grep "msg" -i

  I was able to identify the following attacks:
  - OS File Access Attempt
  - Remote Command Execution
  - Path Traversal Attack
  - SQL Injection Attack Detected libinjection
  - security scanning using sqlmap
  - MSSQL code execution and information gathering attempts
  - concatenated basic SQL injection and SQLLFI attempts
  
# Q3
  
  By checking the user agent from access.log
  
    Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0

$ Q4
  
  (Referring to the output from Q2) The attacker has used sqlmap to find confidential information from the database.
  
# Q5
  
  The attacker was trying to access '/etc/passwd'
  
# Q6
  
  The attacker gained access to the username, email and password of 5 users:
  
    ('user1', 'user1@local.host', 'password1'),
    ('user2', 'user2@local.host', 'password2'),
    ('user3', 'user3@local.host', 'password3'),
    ('user4', 'user4@local.host', 'password4'),
    ('user5', 'user5@local.host', 'password5');
    
# Q7

  Hey there! Just a heads up - if we don't add security checks to our web app, our top-secret files might as well be written on a billboard. And trust me, we don't want that kind of attention. So let's get those checks in place, okay? We wouldn't want the world to know that our password is 'sup3r_s3cr3t_4nd_1mp0rt4nt_p4ssw0rd', now would we? ;)

# Q8

  I found a base64 encoded message in the modsec security logs. Decoding the message gave this flag
    flag{h1pp1ty_h0pp1ty_y0ur_w3bs1t3_1s_n0w_my_pr0p3rty!}

# Q9

  The alerts generated by the modsecurity firewall confirmed that an attack had taken place. The key takeaways of this attack were:
  
  - Attempts to access /etc/passwd and an important note
  - Remote Command Execution (ls -la)
  - Path Traversal Attack (to access the /etc/passwd and important note)
  - SQL Injection (to find out the username, email, password of the users)
  - Security scanning using sqlmap 
  - MSSQL code execution and information gathering attempts
  - concatenated basic SQL injection and SQLLFI attempts
  
# Q10

  The following indicators of compromise can be used to prevent future attacks:
  - Any requests with path traversal/LFI payloads should be blocked (payloads like ../../)
  - Implement secure coding techiniques to block any functions/libraries that execute commands (like os or subprocess)
  - Block suspicious IPs like: 192.168.0.106
  - Identify SQL injections based on 'union select' or 'user1\' and 1=1 #' payloads and block those malicious requests.
